# NAR多標籤分類模型
## 運作環境說明


|  | |
| -------- | -------- |
| CPU     |  AMD Ryzen 7 5800X 8-Core Processor    |
| GPU |GeForce RTX 2070 SUPER |
| RAM |32G |
| HDD |1TB |
| OS |Ubuntu 22.04.1 LTS |

## 任務介紹
對於檔案內容進⾏分類。
- 目前欄位：
    - 0:AI、雲端、巨量資料
    - 1:產業人才培育
    - 2:虛擬實境
    - 3:人才補助與延攬
    - 4:工研院與A+
    - 5:中小（堅）企業輔導
    - 6:化工材料與循環經濟
    - 7:能源
    - 8:太空/衛星
    - 9:文化
    - 10:水資源管理
    - 11:生技醫藥與精準醫療
    - 12:自動駕駛
    - 13:災害防救
    - 14:物聯網
    - 15:網路通訊/4G/5G/5G+/6G
    - 16:防疫
    - 17:創新創業
    - 18:資安
    - 19:長照與社會福利
    - 20:政策規劃與推動
    - 21:科研計畫補助
    - 22:科研設施
    - 23:晶片半導體
    - 24:海洋科技
    - 25:食品安全與食品科技
    - 26:校園人才培育
    - 27:氣候變遷與減碳
    - 28:農業
    - 29:國家標準檢驗
    - 30:國防
    - 31:專利與智財
    - 32:設計
    - 33:智慧交通
    - 34:智慧農業
    - 35:電商與物流
    - 36:智慧製造
    - 37:智慧醫療
    - 38:智慧顯示器
    - 39:傳統產業高值化
    - 40:運輸載具
    - 41:園區管理
    - 42:農業生技
    - 43:運動科技
    - 44:數位內容
    - 45:數位學習
    - 46:數位轉型與智慧政府
    - 47:環境監測與污染防治
    - 48:職安
    - 49:警政與法務

## 資料描述
- 檔案: 103-110概述表含tag.xlsx
    - 檔案資料量總共 3152 筆資料
    - 每筆資料欄位：
        - 系統編號
        - 計劃完整中文名稱
        - 年度
        - 部會
        - 新標籤
        - 中文關鍵詞
        - 英文關鍵詞
        - 本計畫在施政項目之定位及功能
        - 計畫重點描述
        - 最終效益
        - 主要績效指標(~107)
        - 近三年主要績效(108~)
        - 自我挑戰目標
        - 預期效益說明及效益評估方式規劃
    - 所有資料都有標籤

## 前處理

放入計劃名稱、中文關鍵詞和計劃描述，用\n分割

將空資料刪除，剩下3152筆資料

將資料分成train set(2268), validation set(253) 和 test set(631)

## 分類方法
**運⽤ pretrained model 訓練多分類模型**


|參數名稱 |參數 | 
| -------- | -------- | 
| 使用套件    | simpletransformers     |
| Epoch    | 20     |
| model    | bert-base-chinese     |
|max_seq_length|512|
|threshold|0.5|

- 方法描述：
    - 將內容輸⼊預訓練模型 BERT。
    - 將向量輸入分類器得到各類別的機率
    - 設置threshold=0.5，若能達到則會被分類到該標籤

## 實驗結果
- 輸入
    - 單筆資料：[（計劃名稱+中文關鍵詞+計劃描述）,（標籤向量,長度為50的0或1）]
    - 單筆資料*631
- 輸出
    - 單筆資料：（label array,長度為50的0或1）
    - 單筆資料*631
- 對test set使用模型預測（f1-score）

    - micro avg：0.96
    - macro avg：0.93
    - weighted avg：0.96
- 對test set使用模型預測（LRAP）
    - 0.9677
    - 使用5-fold cross validation
        - 0.9729
        - 0.9742
        - 0.9760
        - 0.9774
        - 0.9689
        - Mean：0.9739

- 分類機率呈現
    - 使用其中一筆資料為例，計劃名稱：物聯網應用場域資安強化推動計畫(1/4)
    - 預測標籤：['虛擬實境', '物聯網', '資安']
    - 實際標籤：['虛擬實境', '物聯網', '資安']
    - 2:虛擬實境，14:物聯網，18:資安
    ![](https://i.imgur.com/EOmlucK.png)

- 混淆矩陣
    ![](https://i.imgur.com/P5GkRFw.png)

- 錯誤率
    ![](https://i.imgur.com/r0wiqtT.png)

## 執行時間


| Action | Set | Time|
| -------- | -------- | -------- | 
| Train |Train_set+Validation_set    | 22m 32.239s     | 
| Prediction |Test_set    | 0m 8.644s     | 
|Train|Train_set+Validation_set+Test_set|31m 5.692s|
|Prediction|Train_set+Validation_set+Test_set|0m 36.192s|

## 執行方法

訓練模型：
```
python3 train.py --train_file="檔案名稱.xlsx" --epoch=訓練次數 --finetune_name="被微調的模型名稱"
```

測試模型：
```
python3 test.py --test_file="檔案名稱.xlsx" --model_name="訓練好的模型名稱"
```
預測分類結果：
```
python3 main.py --pred_file="檔案名稱.xlsx" --model_name="模型名稱" --output_file="要輸出的檔案名稱.csv"
```





